---
import type { Shop } from "../../../domain/models/Shop";

interface Props {
  shop: Shop;
}

const { shop } = Astro.props;
---

<div class="cyber-shop min-h-screen bg-[#f0f0f0] font-mono text-black overflow-x-hidden relative py-20 px-4 md:px-12">
    <div class="absolute inset-0 opacity-[0.03] pointer-events-none z-50 bg-[url('https://grainy-gradients.vercel.app/noise.svg')]"></div>

    <div class="max-w-[1800px] mx-auto relative z-10">
        <header class="mb-24 flex items-start justify-between flex-wrap gap-8">
             <div class="bg-black text-white p-4 shadow-[8px_8px_0px_0px_#ff5f1f]">
                <h1 class="text-6xl md:text-9xl font-black uppercase tracking-tighter leading-[0.8]">{shop.name}</h1>
             </div>
             <div class="bg-white border-[3px] border-black p-4 rotate-2 max-w-sm shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]">
                 <p class="font-bold text-lg uppercase leading-tight text-[#ff5f1f]">
                    {shop.description}
                 </p>
             </div>
        </header>

        {shop.categories?.map((category) => (
            <section class="mb-24">
                 <div class="inline-block bg-[#ff5f1f] border-[3px] border-black p-2 mb-12 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]">
                    <h2 class="text-3xl font-black uppercase text-white tracking-widest">>> {category.name}</h2>
                 </div>

                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                     {category.products?.map((product) => (
                         <div class="bg-white border-[3px] border-black p-4 shadow-[6px_6px_0px_0px_#000] hover:shadow-[10px_10px_0px_0px_#ff5f1f] hover:translate-x-[-2px] hover:translate-y-[-2px] transition-all flex flex-col h-full group">
                             <div class="aspect-square bg-gray-200 border-[3px] border-black mb-4 relative overflow-hidden">
                                {product.image_url ? (
                                    <img src={product.image_url} alt={product.name} class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-100" />
                                ) : (
                                    <div class="w-full h-full flex items-center justify-center font-black text-4xl bg-gray-300 text-gray-500 opacity-50">?</div>
                                )}
                                
                                {product.stock <= 0 && (
                                     <div class="absolute inset-0 bg-red-600/80 flex items-center justify-center font-black text-white text-2xl uppercase tracking-widest -rotate-12 border-[3px] border-black m-2">
                                        Sold Out
                                     </div>
                                )}
                             </div>

                             <div class="flex-grow">
                                 <h3 class="text-2xl font-black uppercase leading-none mb-2">{product.name}</h3>
                                 <p class="font-bold text-gray-500 text-sm mb-4 leading-tight">{product.description}</p>
                             </div>

                             <div class="mt-auto pt-4 border-t-[3px] border-black flex justify-between items-center bg-black -mx-4 -mb-4 p-3">
                                 <span class="text-[#ff5f1f] font-black text-xl">${Number(product.price).toFixed(2)}</span>
                                 {product.stock > 0 && (
                                     <button class="bg-white text-black text-xs font-bold uppercase px-3 py-1 hover:bg-[#ff5f1f] hover:text-white transition-colors">
                                        Buy Now
                                     </button>
                                 )}
                             </div>
                         </div>
                     ))}
                 </div>
            </section>
        ))}
    </div>
</div>

<style>
  @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap");
  .cyber-shop { font-family: "Space Grotesk", sans-serif; }
</style>
